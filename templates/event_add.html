<!DOCTYPE html>
<title>Echo :: Add an event</title>

<link rel="stylesheet" type="text/css" href="{{@baseurl}}/css/jquery.timepicker.css">
<link rel="stylesheet" type="text/css" href="{{@baseurl}}/css/jquery-ui-1.8.24.custom.css">

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="{{@baseurl}}/js/jquery-ui-1.8.24.custom.min.js"></script>
<script src="{{@baseurl}}/js/jquery.timepicker.min.js"></script>

<script>
$(function() {

$("#date").hide();

$("#datepicker").datepicker({
	dateFormat: "yy-mm-dd",
	firstDay: 1,
	onSelect: function(dt, inst) { $("#date").val(dt); },
	minDate: 1,
	maxDate: "+2M",
	defaultDate: $("#date").val()
});

$("#time").timepicker({ step: 15, timeFormat: 'H:i' });

$("#film").click(function(e) {
	if (e.target.checked)
		$("#title").addClass("film");
	else
		$("#title").removeClass("film");
});

$("#free").change(function(e) {
   if (e.target.checked)
	   $("#costdiv").hide();
   else
	   $("#costdiv").show();
});

if (!$("#cost").val())
	$("#costdiv").hide();

});
</script>

<F3:include href="header.html" />

<section id="add">
<h2>Add an event</h2>

<F3:check if="{{count(@messages)}}">
<ul>
<F3:repeat group="{{@messages}}" value="{{@message}}">
	<li>{{@message}}
</F3:repeat>
</ul>
</F3:check>

<form method="POST" action="?">

<fieldset>
<label id="ftitle" for="title">Event name:</label>
<input type="text" name="title" id="title" {{@value(@title)}}>
<br>
<label id="flocation" for="location">Where is your event?</label>
<input type="text" name="location" id="location" autocomplete="off" {{@value(@location)}}>

<div class="venues">
<style scoped>
.x { margin-top: 10px; }
ul, li { list-style-type: none; padding: 0; margin: 0; }
ul { height: 104px; border: 1px solid #ccc; border-radius: 4px; }
li { font-size: 80%; width: 289px; float: left; padding: 4px 5px; cursor: pointer; height: 18px; }
li.selected { background-color: #eee; }
li:hover { background-color: #ddd; }
</style>

<script>
$(function() {

if (!Array.prototype.forEach) {
  Array.prototype.forEach = function(fn, scope) {
    for (var i = 0, len = this.length; i < len; ++i) {
      fn.call(scope || this, this[i], i, this);
    }
  }
}

var venuelist = [
	"University of Manchester Students' Union",
	"Central Halls",
	"City Art Gallery Lecture Theatre",
	"Islington Mill",
	"Kraak Gallery",
	"On The Eighth Day CafÃ©",
	"Sand Bar",
	"The Bunker, Plan B"
];

var list = {
	"init": function(list, listelement, bindelement) {
		var t = this;

		this.list = list;
		this.listElem = $(listelement);
		this.bindElem = $(bindelement);

		this.populate(this.list);

		var update = function() {
			t.deselect();
			t.show_only_with($(this).val());
		};

		this.bindElem.keydown(update);
		this.bindElem.keyup(update);
		this.bindElem.change(update);
	},

	"depopulate": function() {
		this.listElem.children().remove();
	},

	"populate": function(list) {
		var t = this;

		list.forEach(function(v) {
			t.listElem.append("<li>" + v + "</li>");
		});
	
		this.listElem.children().each(function(i, e) {
			$(e).click(function(event) {
				t.deselect();
				$(event.target).addClass("selected");
				t.bindElem.val(this.innerText);
			});
		});
	},

	"deselect": function() {
		this.listElem.children().each(function(i, e) {
			$(e).removeClass("selected");
		});
	},

	"show_only_with": function(chars) {
		var chars = chars.toLowerCase();
		var matches = [];

		this.list.forEach(function(value) {
			if (value.toLowerCase().indexOf(chars) != -1)
				matches.push(value);
		});

		this.depopulate();
		this.populate(matches);
	},
};

list.init(venuelist, "#venuelist", "#location");

});
</script>


Or select from below:

<ul id="venuelist">

</ul>

</div>

</fieldset>

<fieldset>
<label id="ffilm" for="film">Is this a film showing?</label>
<input type="checkbox" name="film" id="film" {{@film?'checked':''}}>
</fieldset>
</fieldset>

<fieldset>
<label id="fdate" for="date">When is your event?</label>
<input type="text" name="time" id="time" value="{{@time ? @time : '17:00'}}">
<input type="text" name="date" id="date" {{@value(@date)}} placeholder="yyyy-mm-dd">
<div id="datepicker"></div>
</fieldset>

<fieldset>
<label id="ffree" for="free">Is it free to get in?</label>
<input type="checkbox" name="free" id="free" {{@free?'checked':''}} >

<div id="costdiv">
<label id="fcost" for="cost">How much does it cost?</label>
<input type="text" name="cost" id="cost" {{@value(@cost)}}>
</div>
</fieldset>

<fieldset>
<div class="g">
<label id="fblurb" for="blurb">Please describe your event:</label>
<p class="desc">Please include cost (if not free), the group organising the event and information about booking if you have to book.</p>
</div>

<textarea name="blurb" id="blurb" rows="8">{{@blurb}}</textarea>
</fieldset>

<fieldset>
<div class="g">
<label for="url">URL for more info:</label>
<p class="desc">Is there somewhere on the web people can go to get more information, like a blog post / Facebook event?</p>
</div>

<input type="text" name="url" id="url" {{@value(@url)}}>
</fieldset>

<fieldset>
<label id="femail" for="email">Your email:</label>
<input type="text" name="email" id="email" {{@value(@email)}}>
</fieldset>

<!-- XXX all day? -->

<input type="submit" value="Submit event!">
</form>
</section>

<F3:include href="footer.html" />
