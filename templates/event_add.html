<!DOCTYPE html>
<title>{{@appname}} :: Add an event</title>

<F3:include href="_stylesheets.html" />
<link rel="stylesheet" type="text/css" href="{{@baseurl}}/css/editform.css">
<link rel="stylesheet" type="text/css" href="{{@baseurl}}/css/jquery.timepicker.css">
<link rel="stylesheet" type="text/css" href="{{@baseurl}}/css/jquery-ui-1.8.24.custom.css">

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="{{@baseurl}}/js/jquery-ui-1.8.24.custom.min.js"></script>
<script src="{{@baseurl}}/js/jquery.timepicker.min.js"></script>
<script src="{{@baseurl}}/js/venuelist.js"></script>

<script>
$(function() {

// Datepicker
$("#date").hide();
$("#datepicker").datepicker({
	dateFormat: "yy-mm-dd",
	firstDay: 1,
	onSelect: function(dt, inst) { $("#date").val(dt); },
	minDate: 1,
	maxDate: "+2M",
	defaultDate: $("#date").val()
});

// Timepicker
$("#time").timepicker({ step: 15, timeFormat: 'H:i' });

// Film/free functionality
$("#film").click(function(e) {
	if (e.target.checked)
		$("#title").addClass("film");
	else
		$("#title").removeClass("film");
});

$("#free").change(function(e) {
   if (e.target.checked)
	   $("#costdiv").hide();
   else
	   $("#costdiv").show();
});

if (document.getElementById("free").checked)
	$("#costdiv").hide();

// Venuelist
var mylist = [
	// replace with auto-generated version sometime
	"University of Manchester Students' Union",
	"Central Halls",
	"City Art Gallery Lecture Theatre",
	"Islington Mill",
	"Kraak Gallery",
	"On The Eighth Day Caf√©",
	"Sand Bar",
	"The Bunker, Plan B",
	"Antwerp Mansion",
	"People's History Museum"
];

venuelist.init(mylist, "#vlist", "#location");
venuelist.empty = function(empty) {
	if (empty)
		$("#venues").addClass("empty");
	else
		$("#venues").removeClass("empty");	
};

$("#venues").show();

});
</script>

<body class="thin">
<F3:include href="_header.html" />

<section id="add">
<h2>Add an event</h2>

<F3:check if="{{count(@messages)}}">
<ul>
<F3:repeat group="{{@messages}}" value="{{@message}}">
	<li>{{@message}}
</F3:repeat>
</ul>
</F3:check>

<form method="POST" action="?">

<fieldset>
<label id="ftitle" for="title">Event name:</label>
<input type="text" name="title" id="title" {{@value(@title)}}>
<br>
<label id="flocation" for="location">Where is your event?</label>
<input type="text" name="location" id="location" autocomplete="off" {{@value(@location)}}>

<div id="venues" style="display: none;">Or select from below:
<ul id="vlist"></ul>
</div>
</fieldset>

<fieldset>
<label id="ffilm" for="film">Is this a film showing?</label>
<input type="checkbox" name="film" id="film" {{@film?'checked':''}}>
</fieldset>
</fieldset>

<fieldset>
<label id="fdate" for="date">When is your event?</label>
<input type="text" name="time" id="time" value="{{@time ? @time : '17:00'}}">
<input type="text" name="date" id="date" {{@value(@date)}} placeholder="yyyy-mm-dd">
<div id="datepicker"></div>
</fieldset>

<fieldset>
<label id="ffree" for="free">Is it free to get in?</label>
<input type="checkbox" name="free" id="free" {{@free?'checked':''}} >

<div id="costdiv">
<label id="fcost" for="cost">How much does it cost?</label>
<input type="text" name="cost" id="cost" {{@value(@cost)}}>
</div>
</fieldset>

<fieldset>
<div class="g">
<label id="fblurb" for="blurb">Please describe your event:</label>
<p class="desc">Please include cost (if not free), the group organising the event and information about booking if you have to book.</p>
</div>

<textarea name="blurb" id="blurb" rows="8">{{@blurb}}</textarea>
</fieldset>

<fieldset>
<div class="g">
<label for="url">URL for more info:</label>
<p class="desc">Is there somewhere on the web people can go to get more information, like a blog post / Facebook event?</p>
</div>

<input type="text" name="url" id="url" {{@value(@url)}}>
</fieldset>

<fieldset>
<label id="femail" for="email">Your email:</label>
<input type="text" name="email" id="email" {{@value(@email)}}>
</fieldset>

<!-- XXX all day? -->

<input type="submit" value="Submit event!">
</form>
</section>

<F3:include href="_footer.html" />
